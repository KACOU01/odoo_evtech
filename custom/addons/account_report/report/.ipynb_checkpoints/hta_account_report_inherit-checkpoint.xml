<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="report_account_hta_inherit">

        <t t-call="web.external_layout">

            <t t-set="o" t-value="o.with_context(lang=lang)" />

                <t t-set="forced_vat" t-value="o.fiscal_position_id.foreign_vat"/>

            <div class="row" style="font-family: Times New Roman; margin-top:-20px">

                    <div class="col-6" style="font-size:1em; font-weight:bold;">

                        <p>

                            Client : <span t-field="o.partner_id" /> <br />

                            Adresse : <span t-field="o.partner_id.street" /><br />

                            Pays : <span t-field="o.partner_id.country_id" />

                            Contact : <span t-field="o.partner_id.phone" /> <br />

                            Email : <span t-field="o.partner_id.email" />

                        </p>

                    </div>

                    <div class="col-6">

                        <div class="text-right mt-3" style="font-family: Times New Roman; color:black; font-size:1em; font-weight:bold;">

                            Facture N° :

                            <span t-if="o.move_type == 'out_invoice' and o.state == 'posted'"></span>

                            <span t-if="o.move_type == 'out_invoice' and o.state == 'draft'"></span>

                            <span t-if="o.move_type == 'out_invoice' and o.state == 'cancel'"></span>

                            <span t-if="o.name != '/'" t-field="o.name"/>

                        </div>

                        <div t-if="o.invoice_date" name="invoice_date" class="text-right">

                            <t t-if="o.move_type == 'out_invoice'">Date de la facture : </t>

                            <t t-elif="o.move_type == 'out_refund'"><strong>Credit Note Date:</strong></t>

                            <t t-elif="o.move_type == 'out_receipt'"><strong>Date de réception : </strong></t>

                            <t t-else=""><strong>Date:</strong></t>

                            <span t-field="o.invoice_date"/>

                        </div>

                        <div class="text-right">

                            <p style="font-weight : bold">

                                SUIVANT DEVIS N° : <span t-field="o.invoice_origin" />

                            </p>

                            <p style="font-size:0.8em; font-weight : bold">

                               Date du Devis : <span t-field="o.invoice_date"  /> <br />

                               Non du commercial : <span t-field="o.invoice_user_id"  />

                            </p>

                        </div>

                    </div>

                </div>


            <div id="informations" class="text-center mb-5" style="font-family: Times New Roman; color:#4ab0f6; font-weight:bold; font-size:0.9em">


                        <div class="col-auto col-3 mw-100 mb-2" t-if="o.invoice_origin" name="origin">


                            <strong>Source:</strong>

                            <p class="m-0" t-field="o.invoice_origin"/>

                        </div>

                        <div t-if="o.partner_id.ref" name="customer_code">


                            <strong>Code Client:</strong>

                            <p class="m-0" t-field="o.partner_id.ref"/>

                        </div>

                        <div t-if="o.ref" name="reference">

                            <strong>Reference:</strong>

                            <p class="m-0" t-field="o.ref"/>


                        </div>

                    </div>


                    <t t-set="display_discount" t-value="any(l.discount for l in o.invoice_line_ids)"/>

                    <t t-set="amount_taxed" t-value='0'/>

                    <t t-set="amount_taxed_airsi" t-value='0'/>

                    <table class="table table-sm o_main_table mt-5" name="invoice_line_table" style="font-family:Times New Roman;border">

                        <thead style="font-size:0.9em">

                            <tr>

 

                                <th name="th_description"><span>PRODUIT</span></th>

                                <th name="th_quantity"><span>NBRES CARTONS</span></th>

                                <th name="th_package"><span>NBRES PIECES</span></th>

<!--                                  <th name="th_priceunit" t-attf-class="{{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                                     <span>P.U</span>
                                </th> -->


                                <th name="th_pricarton" t-attf-class="{{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}"><span>PRIX CARTON</span></th>
<!--                                 <th name="th_product_packaging_price" t-if="display_discount" t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
   
                                
                                   
                                
                                    

                                    <span>Disc.%</span>

                                </th> -->
                                
                                

                                <th name="th_taxes" t-attf-class="text-left {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}"><span>TAXES</span></th>

                                <th name="th_subtotal">

 

                                    <span groups="account.group_show_line_subtotals_tax_excluded">MONTANT</span>

                                    <span groups="account.group_show_line_subtotals_tax_included">MONTANT</span>

                                </th>

                            </tr>

                        </thead>

                        <tbody class="invoice_tbody" style="font-size:0.9em">

                            <t t-set="current_subtotal" t-value="0"/>

                            <t t-set="lines" t-value="o.invoice_line_ids.sorted(key=lambda l: (-l.sequence, l.date, l.move_name, -l.id), reverse=True)"/>

                            <t t-set="count_tax" t-value='0'/>

                            <t t-foreach="lines" t-as="line">

                                <t t-if="line.tax_ids">

                                    <t t-foreach="line.tax_ids" t-as="tax">

                                        <t t-if="tax.amount >= 18">

                                            <t t-set="amount_taxed" t-value="amount_taxed + (tax.amount * line.price_subtotal)/100"/>

                                        </t>

                                        <t t-if="tax.amount == 5">

                                            <t t-set="amount_taxed_airsi" t-value="amount_taxed_airsi + (tax.amount * line.price_subtotal)/100"/>

                                        </t>

                                    </t>

                                </t>

                                <t t-set="count_tax" t-value='0'/>

                                <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>

                                <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>

 

                                <tr t-att-class="'bg-200 font-weight-bold o_line_section' if line.display_type == 'line_section' else 'font-italic o_line_note' if line.display_type == 'line_note' else ''">

                                    <t t-if="not line.display_type" name="account_invoice_line_accountable">


                                        <td>

                                            <span t-field="line.product_id.partner_ref"/>

                                        </td>

                                        <td>

                                            <span t-field="line.product_packaging_qty"/>

                                        </td>

                                        <td>

                                            <span t-field="line.quantity"/>

                                        </td>

                                        <td t-attf-class="{{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">

                                            <span class="text-nowrap" t-field="line.product_packaging_price"/>

                                        </td>

<                                        <td t-if="display_discount" t-attf-class="text-righ {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">

                                            <span class="text-nowrap" t-field="line.discount"/>

                                        </td>

                                        <td t-attf-class="text-center {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">

                                            <span t-esc="', '.join(map(lambda x: (x.description or x.name), line.tax_ids))" id="line_tax_ids"/>

                                        </td> 

                                        <td class="text-center o_price_total">

                                            <span class="text-nowrap" t-field="line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>

                                            <span class="text-nowrap" t-field="line.price_total" groups="account.group_show_line_subtotals_tax_included"/>

                                        </td>

                                    </t>

                                    <t t-if="line.display_type == 'line_section'">

                                        <td colspan="99">

                                            <span t-field="line.name" t-options="{'widget': 'text'}"/>

                                        </td>

                                        <t t-set="current_section" t-value="line"/>

                                        <t t-set="current_subtotal" t-value="0"/>

                                    </t>

                                    <t t-if="line.display_type == 'line_note'">

                                        <td colspan="99">

                                            <span t-field="line.name" t-options="{'widget': 'text'}"/>

                                        </td>

                                    </t>

                                </tr>

                                <t t-if="current_section and (line_last or lines[line_index+1].display_type == 'line_section')">

                                    <tr class="is-subtotal text-right">

                                        <td colspan="99">

                                            <strong class="mr16">SOUS TOTAL</strong>

                                            <span

                                                t-esc="current_subtotal"

                                                t-options='{"widget": "monetary", "display_currency": o.currency_id}'

                                            />

                                        </td>

                                    </tr>

                                </t>

                            </t>

                        </tbody>

                    </table>


                    <div class="clearfix" style="font-family: Times New Roman;font-size:0.9em">

                        <div id="total" class="row">

                            <div t-attf-class="#{'col-6' if report_type != 'html' else 'col-sm-7 col-md-6'} ml-auto">

                               <table width="100%" class="table table-sm o_main_table" style="border:0;">

                                    <t>

                                        <tr>

                                            <td class="text-right" width="55%" style="border: 0;"><strong><span>MONTANT HT</span></strong></td>

                                          

                                            <td class="text-right" width="40%" style="border: 0;"><strong><span t-field="o.amount_untaxed" t-options='{&quot;widget&quot;: &quot;False&quot;,"widget": "float", "precision": 0}'/></strong></td>

                                        </tr>

                                    </t>

                                    <t t-if="o.amount_tax">

                                        <tr>

                                            <td class="text-right" width="55%" style="border: 0;"><strong><span>TVA 18%</span></strong></td>

                                           

                                            <td class="text-right" width="40%" style="border: 0;">

                                                <strong>

                                                    <span t-esc="amount_taxed" t-options='{&quot;widget&quot;: &quot;False&quot;,"widget": "float", "precision": 0}'/>

                                                </strong>

                                            </td>

                                        </tr>

                                        <tr>

                                            <td class="text-right" width="55%" style="border: 0;"><strong><span>AIRSI 5%</span></strong></td>

                                           

                                            <td class="text-right" width="40%" style="border: 0;">

                                                <strong>

                                                    <span t-esc="amount_taxed_airsi" t-options='{&quot;widget&quot;: &quot;False&quot;,"widget": "float", "precision": 0}'/>

                                                </strong>

                                            </td>

                                        </tr>

                                    </t>

                                    <tr class="bg-light" style="border: 0;">

                                            <td class="text-right bg-light" style="border: 0;" width="55%"><strong><span>MONTANT TTC</span></strong></td>

                           

                                            <td class="text-right bg-light" style="border: 0;" width="40%"><strong><span t-field="o.amount_total" t-options='{&quot;widget&quot;: &quot;False&quot;,"widget": "float", "precision": 0}'/></strong></td>

                                    </tr>

                                </table>

                            </div>

                        </div>

                    </div>

                <p class="text-uppercase mt-3" style="font-family: Times New Roman;font-size:0.9em;font-weight : bold">

                    arrêté la présente facture à la somme de : <br /> <span t-field="o.amount_to_word"/> <span class="text-uppercase" t-field="o.currency_id.symbol"/>

                </p>

                <div class="row mt-3" style="font-family: Times New Roman;font-size:0.8em">

                    <div class="col-6">

                        <p class="text-uppercase">

                            pour acquit

                        </p>

                    </div>

                    <div class="col-6 text-right" style="font-family: Times New Roman;">

                        <p class="text-uppercase">

                            La direction

                        </p>

                    </div>

                </div>

                <div style="border-top: 1px solid #D6D5CB" class="container-fluid mt-3 mb-2"></div>

                <p class="text-center" style="color:#7b7b7c; font-size:0.8em; font-family:Times New Roman">

                        Merci beaucoup d'avoir fait affaire avec nous. Nous avons hâte de travailler à nouveau avec vous !

                </p>

                    <p t-if="o.move_type in ('out_invoice', 'in_refund') and o.payment_reference" name="payment_communication" class="mt-5">


                    </p>

        </t>

    </template>

   

    <template id="hta_custom_report">

        <t t-call="web.html_container">

            <t t-foreach="docs" t-as="o">

                <t t-call="hta_account_report.report_account_hta_inherit" t-lang="o.partner_id.lang" />

            </t>

        </t>

    </template>
    
    
    
    
    
<!--     <FACTURE EDILAC TRADE SANS ANTETE> -->
    
    
    
    <template id="report_invoice_two">
         <t t-call="web.html_container">
             <t t-foreach="docs" t-as="o">
                 <t t-call="web.internal_layout">
                     <div class="header">
                        <div class="row" style="margin-bottom:60px">
<!--                             <div name="company_address" style="position: absolute; right: 0;font-family: Times New Roman">
                                <p style="font-size:0.8em;"> FACTURE <t t-if="o.invoice_filter_type_domain =='purchase'"> ACHAT </t> <t t-if="o.invoice_filter_type_domain =='sale'"> VENTE </t>  </p>
                            </div> -->
                        </div>
                    </div>
                     

            <div class="row" style="font-family: Times New Roman; margin-top:-20px">

                    <div class="col-6" style="font-size:1em; font-weight:bold;">

                        <p>

                            Client : <span t-field="o.partner_id" /> <br />

                            Adresse : <span t-field="o.partner_id.street" /><br />

                            Pays : <span t-field="o.partner_id.country_id" />

                            Contact : <span t-field="o.partner_id.phone" /> <br />

                            Email : <span t-field="o.partner_id.email" />

                        </p>

                    </div>

                    <div class="col-6">

                        <div class="text-right mt-3" style="font-family: Times New Roman; color:black; font-size:1em; font-weight:bold;">

                            Facture N° :

                            <span t-if="o.move_type == 'out_invoice' and o.state == 'posted'"></span>

                            <span t-if="o.move_type == 'out_invoice' and o.state == 'draft'"></span>

                            <span t-if="o.move_type == 'out_invoice' and o.state == 'cancel'"></span>

                            <span t-if="o.name != '/'" t-field="o.name"/>

                        </div>

                        <div t-if="o.invoice_date" name="invoice_date" class="text-right">

                            <t t-if="o.move_type == 'out_invoice'">Date de la facture : </t>

                            <t t-elif="o.move_type == 'out_refund'"><strong>Credit Note Date:</strong></t>

                            <t t-elif="o.move_type == 'out_receipt'"><strong>Date de réception : </strong></t>

                            <t t-else=""><strong>Date:</strong></t>

                            <span t-field="o.invoice_date"/>

                        </div>

                        <div class="text-right">

                            <p style="font-weight : bold">

                                SUIVANT DEVIS N° : <span t-field="o.invoice_origin" />

                            </p>

                            <p style="font-size:0.8em; font-weight : bold">

                               Date du Devis : <span t-field="o.invoice_date"  /> <br />

                               Non du commercial : <span t-field="o.invoice_user_id"  />

                            </p>

                        </div>

                    </div>

                </div>


            <div id="informations" class="text-center mb-5" style="font-family: Times New Roman; color:#4ab0f6; font-weight:bold; font-size:0.9em">


                        <div class="col-auto col-3 mw-100 mb-2" t-if="o.invoice_origin" name="origin">


                            <strong>Source:</strong>

                            <p class="m-0" t-field="o.invoice_origin"/>

                        </div>

                        <div t-if="o.partner_id.ref" name="customer_code">


                            <strong>Code Client:</strong>

                            <p class="m-0" t-field="o.partner_id.ref"/>

                        </div>

                        <div t-if="o.ref" name="reference">

                            <strong>Reference:</strong>

                            <p class="m-0" t-field="o.ref"/>


                        </div>

                    </div>


                    <t t-set="display_discount" t-value="any(l.discount for l in o.invoice_line_ids)"/>

                    <t t-set="amount_taxed" t-value='0'/>

                    <t t-set="amount_taxed_airsi" t-value='0'/>

                    <table class="table table-sm o_main_table mt-5" name="invoice_line_table" style="font-family:Times New Roman;border">

                        <thead style="font-size:0.9em">

                            <tr>

 

                                <th name="th_description"><span>PRODUIT</span></th>

                                <th name="th_quantity"><span>NBRES CARTONS</span></th>

                                <th name="th_package"><span>NBRES PIECES</span></th>

<!--                                  <th name="th_priceunit" t-attf-class="{{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                                     <span>P.U</span>
                                </th> -->


                                <th name="th_pricarton" t-attf-class="{{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}"><span>PRIX CARTON</span></th>
<!--                                 <th name="th_product_packaging_price" t-if="display_discount" t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
   
                                
                                   
                                
                                    

                                    <span>Disc.%</span>

                                </th> -->
                                
                                

                                <th name="th_taxes" t-attf-class="text-left {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}"><span>TAXES</span></th>

                                <th name="th_subtotal">

 

                                    <span groups="account.group_show_line_subtotals_tax_excluded">MONTANT</span>

                                    <span groups="account.group_show_line_subtotals_tax_included">MONTANT</span>

                                </th>

                            </tr>

                        </thead>

                        <tbody class="invoice_tbody" style="font-size:0.9em">

                            <t t-set="current_subtotal" t-value="0"/>

                            <t t-set="lines" t-value="o.invoice_line_ids.sorted(key=lambda l: (-l.sequence, l.date, l.move_name, -l.id), reverse=True)"/>

                            <t t-set="count_tax" t-value='0'/>

                            <t t-foreach="lines" t-as="line">

                                <t t-if="line.tax_ids">

                                    <t t-foreach="line.tax_ids" t-as="tax">

                                        <t t-if="tax.amount >= 18">

                                            <t t-set="amount_taxed" t-value="amount_taxed + (tax.amount * line.price_subtotal)/100"/>

                                        </t>

                                        <t t-if="tax.amount == 5">

                                            <t t-set="amount_taxed_airsi" t-value="amount_taxed_airsi + (tax.amount * line.price_subtotal)/100"/>

                                        </t>

                                    </t>

                                </t>

                                <t t-set="count_tax" t-value='0'/>

                                <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>

                                <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>

 

                                <tr t-att-class="'bg-200 font-weight-bold o_line_section' if line.display_type == 'line_section' else 'font-italic o_line_note' if line.display_type == 'line_note' else ''">

                                    <t t-if="not line.display_type" name="account_invoice_line_accountable">


                                        <td>

                                            <span t-field="line.product_id.partner_ref"/>

                                        </td>

                                        <td>

                                            <span t-field="line.product_packaging_qty"/>

                                        </td>

                                        <td>

                                            <span t-field="line.quantity"/>

                                        </td>

                                        <td t-attf-class="{{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">

                                            <span class="text-nowrap" t-field="line.product_packaging_price"/>

                                        </td>

<!--                                         <td t-if="display_discount" t-attf-class="text-righ {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">

                                            <span class="text-nowrap" t-field="line.discount"/>

 

                                        </td> -->

                                        <td t-attf-class="text-center {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">

                                            <span t-esc="', '.join(map(lambda x: (x.description or x.name), line.tax_ids))" id="line_tax_ids"/>

                                        </td> 

                                        <td class="text-center o_price_total">

                                            <span class="text-nowrap" t-field="line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>

                                            <span class="text-nowrap" t-field="line.price_total" groups="account.group_show_line_subtotals_tax_included"/>

                                        </td>

                                    </t>

                                    <t t-if="line.display_type == 'line_section'">

                                        <td colspan="99">

                                            <span t-field="line.name" t-options="{'widget': 'text'}"/>

                                        </td>

                                        <t t-set="current_section" t-value="line"/>

                                        <t t-set="current_subtotal" t-value="0"/>

                                    </t>

                                    <t t-if="line.display_type == 'line_note'">

                                        <td colspan="99">

                                            <span t-field="line.name" t-options="{'widget': 'text'}"/>

                                        </td>

                                    </t>

                                </tr>

                                <t t-if="current_section and (line_last or lines[line_index+1].display_type == 'line_section')">

                                    <tr class="is-subtotal text-right">

                                        <td colspan="99">

                                            <strong class="mr16">SOUS TOTAL</strong>

                                            <span

                                                t-esc="current_subtotal"

                                                t-options='{"widget": "monetary", "display_currency": o.currency_id}'

                                            />

                                        </td>

                                    </tr>

                                </t>

                            </t>

                        </tbody>

                    </table>


                    <div class="clearfix" style="font-family: Times New Roman;font-size:0.9em">

                        <div id="total" class="row">

                            <div t-attf-class="#{'col-6' if report_type != 'html' else 'col-sm-7 col-md-6'} ml-auto">

                               <table width="100%" class="table table-sm o_main_table" style="border:0;">

                                    <t>

                                        <tr>

                                            <td class="text-right" width="55%" style="border: 0;"><strong><span>MONTANT HT</span></strong></td>

                                          

                                            <td class="text-right" width="40%" style="border: 0;"><strong><span t-field="o.amount_untaxed" t-options='{&quot;widget&quot;: &quot;False&quot;,"widget": "float", "precision": 0}'/></strong></td>

                                        </tr>

                                    </t>

                                    <t t-if="o.amount_tax">

                                        <tr>

                                            <td class="text-right" width="55%" style="border: 0;"><strong><span>TVA 18%</span></strong></td>

                                           

                                            <td class="text-right" width="40%" style="border: 0;">

                                                <strong>

                                                    <span t-esc="amount_taxed" t-options='{&quot;widget&quot;: &quot;False&quot;,"widget": "float", "precision": 0}'/>

                                                </strong>

                                            </td>

                                        </tr>

                                        <tr>

                                            <td class="text-right" width="55%" style="border: 0;"><strong><span>AIRSI 5%</span></strong></td>

                                           

                                            <td class="text-right" width="40%" style="border: 0;">

                                                <strong>

                                                    <span t-esc="amount_taxed_airsi" t-options='{&quot;widget&quot;: &quot;False&quot;,"widget": "float", "precision": 0}'/>

                                                </strong>

                                            </td>

                                        </tr>

                                    </t>

                                    <tr class="bg-light" style="border: 0;">

                                            <td class="text-right bg-light" style="border: 0;" width="55%"><strong><span>MONTANT TTC</span></strong></td>

                           

                                            <td class="text-right bg-light" style="border: 0;" width="40%"><strong><span t-field="o.amount_total" t-options='{&quot;widget&quot;: &quot;False&quot;,"widget": "float", "precision": 0}'/></strong></td>

                                    </tr>

                                </table>

                            </div>

                        </div>

                    </div>

                <p class="text-uppercase mt-3" style="font-family: Times New Roman;font-size:0.9em;font-weight : bold">

                    arrêté la présente facture à la somme de : <br /> <span t-field="o.amount_to_word"/> <span class="text-uppercase" t-field="o.currency_id.symbol"/>

                </p>

                <div class="row mt-3" style="font-family: Times New Roman;font-size:0.8em">

                    <div class="col-6">

                        <p class="text-uppercase">

                            pour acquit

                        </p>

                    </div>

                    <div class="col-6 text-right" style="font-family: Times New Roman;">

                        <p class="text-uppercase">

                            La direction

                        </p>

                    </div>

                </div>

                <div style="border-top: 1px solid #D6D5CB" class="container-fluid mt-3 mb-2"></div>

                <p class="text-center" style="color:#7b7b7c; font-size:0.8em; font-family:Times New Roman">

                        Merci beaucoup d'avoir fait affaire avec nous. Nous avons hâte de travailler à nouveau avec vous !

                </p>

                    <p t-if="o.move_type in ('out_invoice', 'in_refund') and o.payment_reference" name="payment_communication" class="mt-5">


                    </p>
                    
                 </t>
            </t>
        </t>
    </template>
   

</odoo>